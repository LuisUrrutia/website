---
interface ThemedIcon {
	light: string;
	dark: string;
}

type ColorMode = "keep" | "auto";

interface Props {
	name: string;
	icon: string | ThemedIcon;
	colorMode?: ColorMode;
	experience: number;
	class?: string;
}

const {
	name,
	icon,
	colorMode = "keep",
	experience,
	class: className,
} = Astro.props;

const isThemedIcon = typeof icon === "object";
const iconSrc = isThemedIcon ? null : icon;
const lightIcon = isThemedIcon ? icon.light : null;
const darkIcon = isThemedIcon ? icon.dark : null;
const isAutoColor = !isThemedIcon && colorMode === "auto";

const formatExperience = (years: number) => {
	if (years < 1) return "Less than 1 year of experience";
	if (years === 1) return "+1 year of experience";
	return `+${years} years of experience`;
};
---

<div class:list={["flex items-center gap-3 p-2", className]}>
	{
		isThemedIcon ? (
			<>
				<img
					src={lightIcon}
					alt=""
					aria-hidden="true"
					class="tech-icon tech-icon-light size-12 object-contain"
					width="48"
					height="48"
					loading="lazy"
					decoding="async"
				/>
				<img
					src={darkIcon}
					alt=""
					aria-hidden="true"
					class="tech-icon tech-icon-dark size-12 object-contain"
					width="48"
					height="48"
					loading="lazy"
					decoding="async"
				/>
			</>
		) : (
			<img
				src={iconSrc}
				alt=""
				aria-hidden="true"
				class:list={[
					"size-12 object-contain",
					{ "tech-icon-auto": isAutoColor },
				]}
				width="48"
				height="48"
				loading="lazy"
				decoding="async"
			/>
		)
	}
	<div class="flex flex-col gap-0.5">
		<span class="text-lg font-medium text-title">{name}</span>
		<span class="text-sm text-subtitle">
			{formatExperience(experience)}
		</span>
	</div>
</div>

<style>
	/* Default: show light icon, hide dark */
	.tech-icon-dark {
		display: none;
	}

	/* Dark theme: show dark icon, hide light */
	:global([data-theme="dark"]) .tech-icon-light {
		display: none;
	}

	:global([data-theme="dark"]) .tech-icon-dark {
		display: block;
	}

	/* Auto color mode: invert colors in dark theme */
	:global([data-theme="dark"]) .tech-icon-auto {
		filter: invert(1);
	}
</style>
