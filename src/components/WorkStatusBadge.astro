---
import IconCircle from "@/assets/icons/circle.svg";
import IconLaptop from "@/assets/icons/laptop.svg";

type WorkStatus = "open" | "busy";

interface Props {
	status: WorkStatus;
	texts?: {
		open?: string;
		busy?: string;
	};
}

const DEFAULT_TEXTS = {
	open: "Open to work",
	busy: "Currently working",
} as const;

const { status, texts } = Astro.props;

const isOpen = status === "open";
const statusText = isOpen
	? (texts?.open ?? DEFAULT_TEXTS.open)
	: (texts?.busy ?? DEFAULT_TEXTS.busy);
---

<div class="relative w-fit h-fit">
	{!isOpen && <div class="gradient-border absolute -inset-px rounded-3xl" />}

	<div
		class:list={[
			"relative inline-flex w-fit cursor-pointer items-center justify-center gap-2.5 rounded-3xl px-3 py-1.5 text-center text-xs",
			isOpen ? "bg-available text-available-foreground" : "bg-card text-title",
		]}
	>
		{
			isOpen ? (
				<IconCircle class="ripple size-1.5 rounded-full" />
			) : (
				<IconLaptop class="size-3 text-title" />
			)
		}
		{statusText}
	</div>
</div>

<style>
	.gradient-border {
		background: linear-gradient(
			60deg,
			oklch(72% 0.19 255),
			oklch(72% 0.19 300),
			oklch(72% 0.19 345),
			oklch(72% 0.19 30),
			oklch(72% 0.19 85),
			oklch(72% 0.19 130),
			oklch(72% 0.19 175),
			oklch(72% 0.19 220)
		);
		background-size: 300% 300%;
		animation: gradient-shift 4s ease infinite alternate;
	}

	@keyframes gradient-shift {
		from {
			background-position: 0% 50%;
		}
		to {
			background-position: 100% 50%;
		}
	}

	.ripple {
		position: relative;
	}

	.ripple::after {
		content: "";
		position: absolute;
		inset: 0;
		border-radius: inherit;
		background-color: currentColor;
		animation: ripple 1.7s linear infinite;
		will-change: transform, opacity;
	}

	@keyframes ripple {
		0% {
			transform: scale(1);
			opacity: 0.4;
		}
		70% {
			transform: scale(9);
			opacity: 0;
		}
		100% {
			transform: scale(9);
			opacity: 0;
		}
	}
</style>
