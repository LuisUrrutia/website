---
import IconCircle from "@/assets/icons/circle.svg";
import IconLaptop from "@/assets/icons/laptop.svg";

type WorkStatus = "open" | "busy";

interface Props {
	status: WorkStatus;
	/** Status text to display. */
	statusText: string;
	/** Accessible description for the status badge. */
	description?: string;
}

const { status, statusText, description } = Astro.props;

const isOpen = status === "open";
const descriptionId = description ? "work-status-description" : undefined;
---

<div class="relative h-fit w-fit">
	{!isOpen && <div class="gradient-border absolute -inset-px rounded-3xl" />}

	<div
		class:list={[
			"relative inline-flex w-fit items-center justify-center gap-2.5 rounded-3xl px-3 py-1.5 text-center text-xs",
			isOpen ? "bg-available text-available-foreground" : "bg-card text-title",
		]}
		role="status"
		aria-describedby={descriptionId}
	>
		{
			isOpen ? (
				<IconCircle class="ripple size-1.5 rounded-full" aria-hidden="true" />
			) : (
				<IconLaptop class="text-title size-3" aria-hidden="true" />
			)
		}
		{statusText}
	</div>
	{
		description && (
			<span id={descriptionId} class="sr-only">
				{description}
			</span>
		)
	}
</div>

<style>
	.gradient-border {
		background: linear-gradient(
			90deg,
			oklch(72% 0.19 255),
			oklch(72% 0.19 300),
			oklch(72% 0.19 345),
			oklch(72% 0.19 30),
			oklch(72% 0.19 85)
		);
		animation: gradient-hue 4s linear infinite;
		will-change: filter;
	}

	@keyframes gradient-hue {
		from {
			filter: hue-rotate(0deg);
		}
		to {
			filter: hue-rotate(360deg);
		}
	}

	.ripple {
		position: relative;
	}

	.ripple::after {
		content: "";
		position: absolute;
		inset: 0;
		border-radius: inherit;
		background-color: currentColor;
		animation: ripple 1.7s linear infinite;
		will-change: transform, opacity;
	}

	@keyframes ripple {
		0% {
			transform: scale(1);
			opacity: 0.4;
		}
		70% {
			transform: scale(9);
			opacity: 0;
		}
		100% {
			transform: scale(9);
			opacity: 0;
		}
	}

	@media (prefers-reduced-motion: reduce) {
		.gradient-border {
			animation: none;
		}

		.ripple::after {
			animation: none;
			opacity: 0.4;
		}
	}
</style>
