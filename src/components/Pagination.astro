---
interface Props {
	currentPage: number;
	totalPages: number;
	baseUrl: string;
	class?: string;
}

const { currentPage, totalPages, baseUrl, class: className } = Astro.props;

// Generate page numbers to show
function getPageNumbers(current: number, total: number): (number | "...")[] {
	if (total <= 7) {
		return Array.from({ length: total }, (_, i) => i + 1);
	}

	const pages: (number | "...")[] = [];

	// Always show first page
	pages.push(1);

	if (current > 3) {
		pages.push("...");
	}

	// Show pages around current
	for (
		let i = Math.max(2, current - 1);
		i <= Math.min(total - 1, current + 1);
		i++
	) {
		pages.push(i);
	}

	if (current < total - 2) {
		pages.push("...");
	}

	// Always show last page
	if (total > 1) {
		pages.push(total);
	}

	return pages;
}

const pageNumbers = getPageNumbers(currentPage, totalPages);

function getPageUrl(page: number): string {
	if (page === 1) {
		return baseUrl;
	}
	return `${baseUrl}/page/${page}`;
}
---

{
	totalPages > 1 && (
		<nav
			class:list={["flex items-center justify-center gap-2", className]}
			aria-label="Pagination"
		>
			{/* Previous button */}
			{currentPage > 1 ? (
				<a
					href={getPageUrl(currentPage - 1)}
					class="text-subtitle hover:text-title rounded-lg px-3 py-2 transition-colors hover:bg-white/5"
					aria-label="Previous page"
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="20"
						height="20"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
					>
						<path d="m15 18-6-6 6-6" />
					</svg>
				</a>
			) : (
				<span class="text-subtitle/50 cursor-not-allowed px-3 py-2">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="20"
						height="20"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
					>
						<path d="m15 18-6-6 6-6" />
					</svg>
				</span>
			)}

			{/* Page numbers */}
			{pageNumbers.map((page) =>
				page === "..." ? (
					<span class="text-subtitle px-2">...</span>
				) : page === currentPage ? (
					<span
						class="bg-accent text-accent-foreground min-w-[2.5rem] rounded-lg px-3 py-2 text-center font-medium"
						aria-current="page"
					>
						{page}
					</span>
				) : (
					<a
						href={getPageUrl(page)}
						class="text-subtitle hover:text-title min-w-[2.5rem] rounded-lg px-3 py-2 text-center transition-colors hover:bg-white/5"
					>
						{page}
					</a>
				),
			)}

			{/* Next button */}
			{currentPage < totalPages ? (
				<a
					href={getPageUrl(currentPage + 1)}
					class="text-subtitle hover:text-title rounded-lg px-3 py-2 transition-colors hover:bg-white/5"
					aria-label="Next page"
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="20"
						height="20"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
					>
						<path d="m9 18 6-6-6-6" />
					</svg>
				</a>
			) : (
				<span class="text-subtitle/50 cursor-not-allowed px-3 py-2">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="20"
						height="20"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
					>
						<path d="m9 18 6-6-6-6" />
					</svg>
				</span>
			)}
		</nav>
	)
}
