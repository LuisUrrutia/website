---
import { getCollection } from "astro:content";
import BlogPage from "@/views/BlogPage.astro";
import { matchesLocale } from "@/i18n";

const POSTS_PER_PAGE = 10;

// Get all non-draft posts for Spanish locale, sorted by date
const allPosts = await getCollection("blog", ({ data }) =>
	matchesLocale("es")(data),
);

allPosts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

const totalPages = Math.ceil(allPosts.length / POSTS_PER_PAGE);
const posts = allPosts.slice(0, POSTS_PER_PAGE);
---

<BlogPage posts={posts} currentPage={1} totalPages={totalPages} />
